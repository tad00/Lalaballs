{const o=exports;
const e=require;
Object.defineProperty(o,"__esModule",{value:!0});var i=e("PPBB_FileUtils"),n=e("PPBB_EventCenter"),a=0,s=function(){function e(){}return e.startLoad=function(e){void 0===e&&(e="loadSubpackage"),a=0,this[e]()},e.loadSubpackage=function(){var e=this,t=this.loadProgress.loadSubPackage.progress;a+=t,console.time("\u5206\u5305\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6");e.initBasePercent(t),console.timeEnd("\u5206\u5305\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u5206\u5305\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadConfig()},e.loadConfig=function(){var e=this,t=this.loadProgress.loadConfig.progress;a+=t,console.time("config\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("load/config",function(o,i,n){e.initProgress(o/i,t)},function(o,n,s){if(o)cc.error(o);else{for(var r=[],c=0,l=n;c<l.length;c++){var h=l[c];if(h.constructor===cc.JsonAsset)r.push(h);else if(h.constructor===cc.TextAsset)h.text}for(var d=0,u=r;d<u.length;d++){var p=u[d];i.default.ResourcesData.Config[p.name]||(i.default.ResourcesData.Config[p.name]=p.json)}e.initBasePercent(t),console.timeEnd("config\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("config\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadImage()}})},e.loadImage=function(){var e=this,t=this.loadProgress.loadTexture.progress;a+=t,console.time("\u56fe\u7247\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("load/image",cc.SpriteFrame,function(o,i,n){e.initProgress(o/i,t)},function(o,n){if(o)cc.error(o);else{for(var s=0,r=n;s<r.length;s++){var c=r[s];i.default.ResourcesData.Texture[c.name]=c}e.initBasePercent(t),console.timeEnd("\u56fe\u7247\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u56fe\u7247\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadSound()}})},e.loadSound=function(){var e=this,t=this.loadProgress.loadSound.progress;a+=t,console.time("\u58f0\u97f3\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("load/sound",cc.AudioClip,function(o,i,n){e.initProgress(o/i,t)},function(o,n,s){if(o)cc.error(o);else{for(var r=0;r<n.length;r++){var c=i.default.getSimpleUrl(s[r]);i.default.ResourcesData.Sound[c]=n[r]}e.initBasePercent(t),console.timeEnd("\u58f0\u97f3\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u58f0\u97f3\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadPrefab()}})},e.loadPrefab=function(){var e=this,t=this.loadProgress.loadPrefab.progress;a+=t,console.time("\u9884\u5236\u4ef6\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),cc.loader.loadResDir("load/prefab",cc.Prefab,function(o,i,n){e.initProgress(o/i,t)},function(o,n,s){if(o)cc.error(o);else{for(var r=0,c=n;r<c.length;r++){var l=c[r];i.default.ResourcesData.Prefab[l.name]=l}e.initBasePercent(t),console.timeEnd("\u9884\u5236\u4ef6\u52a0\u8f7d\u5b8c\u6bd5"+a+"%,\u8017\u65f6"),console.log("\u9884\u5236\u4ef6\u52a0\u8f7d\u5b8c\u6bd5"+a+"%"),e.loadComplete()}})},e.loadComplete=function(){this.beLoaded=!0,n.default.post("load_over")},e.initProgress=function(e,t){if(e!==1/0&&!Object.is(e,NaN)){var o=e*t;this.curPercent=Math.max(this.basePercent+o,this.curPercent),n.default.post("percent_change",Math.floor(this.curPercent))}},e.initBasePercent=function(e){this.basePercent+=e,n.default.post("percent_change",Math.floor(this.basePercent))},e.basePercent=0,e.curPercent=0,e.beLoaded=!1,e.loadProgress={loadSubPackage:{progress:0,desc:""},loadConfig:{progress:0,desc:""},loadTexture:{progress:0,desc:""},loadSound:{progress:0,desc:""},loadPrefab:{progress:0,desc:""}},e}();o.default=s}